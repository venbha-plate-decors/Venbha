import{s as c}from"./index-B7vaWEmF.js";const a=async()=>{try{const{data:e,error:s}=await c.from("collection_enquiries").select("*").order("created_at",{ascending:!1});return s?(console.error("Fetch error:",s),{success:!1,error:s}):{success:!0,data:e||[]}}catch(e){return console.error("Fetch error:",e),{success:!1,error:e}}},l=async e=>{try{console.log("Attempting to insert collection entry:",e);const{data:s,error:r}=await c.from("collection_enquiries").insert([{name:e.name,email:e.email,phone:e.phone,message:e.message,design_name:e.design_name,selected_sets:e.selected_sets,status:"new"}]).select();if(r)return console.error("Supabase insert error:",r),{success:!1,error:r};console.log("Successfully inserted into database:",s);try{const o=new FormData;o.append("_subject",`New Collection Enquiry for ${e.design_name} from ${e.name}`),o.append("name",e.name),o.append("email",e.email),o.append("phone",e.phone),o.append("design_name",e.design_name),o.append("selected_sets",e.selected_sets||"N/A"),o.append("message",e.message),o.append("_template","table"),o.append("_captcha","false"),(await fetch("https://formsubmit.co/kvsnavee@gmail.com",{method:"POST",body:o,headers:{Accept:"application/json"}})).ok?console.log("Email notification sent successfully via Formsubmit.co"):console.warn("Email notification failed")}catch(o){console.warn("Email notification error:",o)}return{success:!0,data:s[0]}}catch(s){return console.error("Unexpected error in addCollectionEntry:",s),{success:!1,error:s}}},i=async(e,s)=>{try{const{error:r}=await c.from("collection_enquiries").update({notes:s}).eq("id",e);return r?(console.error("Update notes error:",r),{success:!1,error:r}):{success:!0}}catch(r){return console.error("Update notes error:",r),{success:!1,error:r}}},u=async(e,s)=>{try{const{error:r}=await c.from("collection_enquiries").update({workflow_status:s}).eq("id",e);return r?(console.error("Update workflow status error:",r),{success:!1,error:r}):{success:!0}}catch(r){return console.error("Update workflow status error:",r),{success:!1,error:r}}},d=async e=>{try{const{error:s}=await c.from("collection_enquiries").delete().eq("id",e);return s?(console.error("Delete error:",s),{success:!1,error:s}):{success:!0}}catch(s){return console.error("Delete error:",s),{success:!1,error:s}}};export{l as a,u as b,d,a as f,i as u};
