import{s as t}from"./index-qGoFLwPU.js";const a=async()=>{try{const{data:e,error:r}=await t.from("collection_enquiries").select("*").order("created_at",{ascending:!1});return r?(console.error("Fetch error:",r),{success:!1,error:r}):{success:!0,data:e||[]}}catch(e){return console.error("Fetch error:",e),{success:!1,error:e}}},l=async e=>{try{console.log("Attempting to insert collection entry:",e);const{data:r,error:s}=await t.from("collection_enquiries").insert([{name:e.name,email:e.email,phone:e.phone,message:e.message,design_name:e.design_name,selected_sets:e.selected_sets,event_date:e.event_date||null,status:"new"}]).select();if(s)return console.error("Supabase insert error:",s),{success:!1,error:s};console.log("Successfully inserted into database:",r);try{const o=new FormData;o.append("_subject",`New Collection Enquiry for ${e.design_name} from ${e.name}`),o.append("name",e.name),o.append("email",e.email),o.append("phone",e.phone),o.append("event_date",e.event_date||"Not specified"),o.append("design_name",e.design_name),o.append("selected_sets",e.selected_sets||"N/A"),o.append("message",e.message),o.append("_template","table"),o.append("_captcha","false"),(await fetch("https://formsubmit.co/kvsnavee@gmail.com",{method:"POST",body:o,headers:{Accept:"application/json"}})).ok?console.log("Email notification sent successfully via Formsubmit.co"):console.warn("Email notification failed")}catch(o){console.warn("Email notification error:",o)}return{success:!0,data:r[0]}}catch(r){return console.error("Unexpected error in addCollectionEntry:",r),{success:!1,error:r}}},i=async(e,r)=>{try{const{error:s}=await t.from("collection_enquiries").update({notes:r}).eq("id",e);return s?(console.error("Update notes error:",s),{success:!1,error:s}):{success:!0}}catch(s){return console.error("Update notes error:",s),{success:!1,error:s}}},u=async(e,r)=>{try{const{error:s}=await t.from("collection_enquiries").update({workflow_status:r}).eq("id",e);return s?(console.error("Update workflow status error:",s),{success:!1,error:s}):{success:!0}}catch(s){return console.error("Update workflow status error:",s),{success:!1,error:s}}},d=async(e,r)=>{try{const{error:s}=await t.from("collection_enquiries").update({status:r}).eq("id",e);return s?(console.error("Update status error:",s),{success:!1,error:s}):{success:!0}}catch(s){return console.error("Update status error:",s),{success:!1,error:s}}},p=async e=>{try{const{error:r}=await t.from("collection_enquiries").delete().eq("id",e);return r?(console.error("Delete error:",r),{success:!1,error:r}):{success:!0}}catch(r){return console.error("Delete error:",r),{success:!1,error:r}}};export{l as a,i as b,u as c,p as d,a as f,d as u};
